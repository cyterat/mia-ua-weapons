2025-08-19 11:16:54,464 - INFO - 1/5 Importing data...
2025-08-19 11:16:56,877 - DEBUG - Rows: 873,113
2025-08-19 11:16:56,877 - DEBUG - Nulls: [('brandmodel', 2292), ('producer', 161765), ('weapontype', 5651), ('weaponkind', 1), ('weaponseries', 423225), ('weaponnumber', 1), ('weaponcaliber', 7798), ('trunks', 119483), ('graduationyear', 137993), ('organunit', 4), ('reasonsearch', 0), ('insertdate', 0), ('theftdate', 599)]
2025-08-19 11:16:56,877 - DEBUG - Sample (First): shape: (1, 13)
┌────────────┬────────────┬────────────┬────────────┬───┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ brandmodel ┆ producer   ┆ weapontype ┆ weaponkind ┆ … ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---        ┆ ---        ┆ ---        ┆   ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str        ┆ str        ┆ str        ┆   ┆ str                             ┆ str          ┆ str                 ┆ str                 │
╞════════════╪════════════╪════════════╪════════════╪═══╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ НАГАН      ┆ ВІТЧИЗНЯНЕ ┆ НАРІЗНА    ┆ РЕВОЛЬВЕР  ┆ … ┆ МАНГУШСЬКЕ ВІДДІЛЕННЯ ПОЛІЦІЇ … ┆ ВИКРАДЕННЯ   ┆ 1978-03-09T00:00:00 ┆ 1978-03-09T00:00:00 │
└────────────┴────────────┴────────────┴────────────┴───┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:16:56,877 - DEBUG - Sample (Last): shape: (1, 13)
┌────────────┬──────────┬────────────────┬────────────────────┬───┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ brandmodel ┆ producer ┆ weapontype     ┆ weaponkind         ┆ … ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---      ┆ ---            ┆ ---                ┆   ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str      ┆ str            ┆ str                ┆   ┆ str                             ┆ str          ┆ str                 ┆ str                 │
╞════════════╪══════════╪════════════════╪════════════════════╪═══╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ ТОЗБ       ┆ ІНОЗЕМНЕ ┆ ГЛАДКОСТВОЛЬНА ┆ РУШНИЦЯ МИСЛИВСЬКА ┆ … ┆ КИЄВО-СВЯТОШИНСЬКИЙ ВІДДІЛ ПОЛ… ┆ ВТРАТА       ┆ 2025-07-25T18:43:01 ┆ 2025-07-24T00:00:00 │
└────────────┴──────────┴────────────────┴────────────────────┴───┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:16:56,877 - DEBUG - Estimated Size: 204 MB
2025-08-19 11:16:56,877 - INFO - 2/5 Dropping duplicate rows...
2025-08-19 11:16:57,827 - DEBUG - Rows: 872,752
2025-08-19 11:16:57,827 - DEBUG - Nulls: [('brandmodel', 2283), ('producer', 161708), ('weapontype', 5632), ('weaponkind', 1), ('weaponseries', 423044), ('weaponnumber', 1), ('weaponcaliber', 7785), ('trunks', 119440), ('graduationyear', 137881), ('organunit', 4), ('reasonsearch', 0), ('insertdate', 0), ('theftdate', 599)]
2025-08-19 11:16:57,827 - DEBUG - Sample (First): shape: (1, 13)
┌────────────┬────────────┬─────────────────┬─────────────────────┬───┬─────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ brandmodel ┆ producer   ┆ weapontype      ┆ weaponkind          ┆ … ┆ organunit                   ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---        ┆ ---             ┆ ---                 ┆   ┆ ---                         ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str        ┆ str             ┆ str                 ┆   ┆ str                         ┆ str          ┆ str                 ┆ str                 │
╞════════════╪════════════╪═════════════════╪═════════════════════╪═══╪═════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ ФОРТ12Р    ┆ ВІТЧИЗНЯНЕ ┆ ПІД ГУМОВУ КУЛЮ ┆ ПІСТОЛЕТ ПІД ГУМОВУ ┆ … ┆ КИЄВО-СВЯТОШИНСЬКИЙ ВІДДІЛ  ┆ ВТРАТА       ┆ 2024-08-09T18:05:31 ┆ 2024-08-09T00:00:00 │
│            ┆            ┆                 ┆ КУЛЮ                ┆   ┆ ПОЛ…                        ┆              ┆                     ┆                     │
└────────────┴────────────┴─────────────────┴─────────────────────┴───┴─────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:16:57,842 - DEBUG - Sample (Last): shape: (1, 13)
┌────────────┬────────────┬────────────┬────────────┬───┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ brandmodel ┆ producer   ┆ weapontype ┆ weaponkind ┆ … ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---        ┆ ---        ┆ ---        ┆   ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str        ┆ str        ┆ str        ┆   ┆ str                             ┆ str          ┆ str                 ┆ str                 │
╞════════════╪════════════╪════════════╪════════════╪═══╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ МКМ072СБ   ┆ ВІТЧИЗНЯНЕ ┆ НАРІЗНА    ┆ КАРАБІН    ┆ … ┆ ГОЛОВНЕ УПРАВЛІННЯ НАЦІОНАЛЬНО… ┆ ВТРАТА       ┆ 2018-05-17T18:13:03 ┆ 2018-05-17T00:00:00 │
└────────────┴────────────┴────────────┴────────────┴───┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:16:57,842 - INFO - 3/5 Selecting required columns...
2025-08-19 11:16:58,810 - DEBUG - Rows: 872,752
2025-08-19 11:16:58,810 - DEBUG - Nulls: [('weaponkind', 1), ('organunit', 4), ('reasonsearch', 0), ('insertdate', 0), ('theftdate', 599)]
2025-08-19 11:16:58,810 - DEBUG - Sample (First): shape: (1, 5)
┌────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str                             ┆ str          ┆ str                 ┆ str                 │
╞════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ АВТОМАТ    ┆ ВОЗНЕСЕНСЬКИЙ ВІДДІЛ ПОЛІЦІЇ Г… ┆ ВТРАТА       ┆ 2024-10-09T12:28:03 ┆ 2022-03-18T00:00:00 │
└────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:16:58,810 - DEBUG - Sample (Last): shape: (1, 5)
┌────────────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind         ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---                ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str                ┆ str                             ┆ str          ┆ str                 ┆ str                 │
╞════════════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ РУШНИЦЯ МИСЛИВСЬКА ┆ ІРПІНСЬКИЙ ВІДДІЛ ПОЛІЦІЇ ГУНП… ┆ ВТРАТА       ┆ 2015-05-19T16:43:41 ┆ 2015-05-19T00:00:00 │
└────────────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:16:58,810 - INFO - 4/5 Casting datatypes...
2025-08-19 11:16:59,920 - DEBUG - Rows: 872,752
2025-08-19 11:16:59,920 - DEBUG - Nulls: [('weaponkind', 1), ('organunit', 4), ('reasonsearch', 0), ('insertdate', 0), ('theftdate', 599)]
2025-08-19 11:16:59,920 - DEBUG - Sample (First): shape: (1, 5)
┌────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str                             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ ГРАНАТОМЕТ ┆ ЧУГУЇВСЬКИЙ ВІДДІЛ ПОЛІЦІЇ ГУН… ┆ ВТРАТА       ┆ 2024-10-22 12:33:22 ┆ 2024-10-21 00:00:00 │
└────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:16:59,920 - DEBUG - Sample (Last): shape: (1, 5)
┌────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str                             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ КУЛЕМЕТ    ┆ ГОЛОВНЕ УПРАВЛІННЯ НАЦІОНАЛЬНО… ┆ ВИКРАДЕННЯ   ┆ 2017-11-14 12:03:02 ┆ 2014-03-31 00:00:00 │
└────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:16:59,920 - INFO - 5/5 Dropping rows with missing values...
2025-08-19 11:17:01,639 - DEBUG - Dropped rows full of nulls.
2025-08-19 11:17:01,639 - DEBUG - Rows: 872,752
2025-08-19 11:17:01,639 - DEBUG - Nulls: [('weaponkind', 1), ('organunit', 4), ('reasonsearch', 0), ('insertdate', 0), ('theftdate', 599)]
2025-08-19 11:17:01,639 - DEBUG - Sample (First): shape: (1, 5)
┌──────────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind       ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---              ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str              ┆ str                             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞══════════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ ПІСТОЛЕТ ГАЗОВИЙ ┆ МЕЛІТОПОЛЬСЬКИЙ ВІДДІЛ ПОЛІЦІЇ… ┆ ВТРАТА       ┆ 2009-02-18 00:00:00 ┆ 2003-05-11 00:00:00 │
└──────────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:17:01,639 - DEBUG - Sample (Last): shape: (1, 5)
┌──────────────────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind               ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---                      ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str                      ┆ str                             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞══════════════════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ ПІСТОЛЕТ ПІД ГУМОВУ КУЛЮ ┆ ТОКМАЦЬКЕ ВІДДІЛЕННЯ ПОЛІЦІЇ П… ┆ ВИКРАДЕННЯ   ┆ 2013-01-24 00:00:00 ┆ 2013-01-23 00:00:00 │
└──────────────────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:17:03,461 - DEBUG - Dropped rows with any string values missing.
2025-08-19 11:17:03,461 - DEBUG - Rows: 872,747
2025-08-19 11:17:03,476 - DEBUG - Nulls: [('weaponkind', 0), ('organunit', 0), ('reasonsearch', 0), ('insertdate', 0), ('theftdate', 596)]
2025-08-19 11:17:03,476 - DEBUG - Sample (First): shape: (1, 5)
┌────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str                             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ ПІСТОЛЕТ   ┆ ГОЛОВНЕ УПРАВЛІННЯ НАЦІОНАЛЬНО… ┆ ВИКРАДЕННЯ   ┆ 2017-10-25 15:17:59 ┆ 2014-03-31 00:00:00 │
└────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:17:03,476 - DEBUG - Sample (Last): shape: (1, 5)
┌────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str                             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ АВТОМАТ    ┆ ПОЛОГІВСЬКИЙ ВІДДІЛ ПОЛІЦІЇ ГУ… ┆ ВТРАТА       ┆ 2025-06-20 12:45:52 ┆ 2025-06-19 00:00:00 │
└────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:17:05,286 - DEBUG - Dropped rows with both datetime values missing.
2025-08-19 11:17:05,286 - DEBUG - Rows: 872,747
2025-08-19 11:17:05,286 - DEBUG - Nulls: [('weaponkind', 0), ('organunit', 0), ('reasonsearch', 0), ('insertdate', 0), ('theftdate', 596)]
2025-08-19 11:17:05,288 - DEBUG - Sample (First): shape: (1, 5)
┌──────────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind       ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---              ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str              ┆ str                             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞══════════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ ПІСТОЛЕТ ГАЗОВИЙ ┆ ДНІПРОВСЬКИЙ ВІДДІЛ ПОЛІЦІЇ ГУ… ┆ ВТРАТА       ┆ 2019-03-15 12:55:51 ┆ 2019-03-14 00:00:00 │
└──────────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:17:05,292 - DEBUG - Sample (Last): shape: (1, 5)
┌────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str                             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ АВТОМАТ    ┆ ОХТИРСЬКИЙ ВІДДІЛ ПОЛІЦІЇ ГУНП… ┆ ВИКРАДЕННЯ   ┆ 2022-08-11 12:22:49 ┆ 2022-08-05 00:00:00 │
└────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:17:05,292 - INFO - 1/4 Transform 'reasonsearch' column...
2025-08-19 11:17:07,152 - DEBUG - Rows: 872,747
2025-08-19 11:17:07,152 - DEBUG - Nulls: [('weaponkind', 0), ('organunit', 0), ('report', 0), ('insertdate', 0), ('theftdate', 596)]
2025-08-19 11:17:07,152 - DEBUG - Sample (First): shape: (1, 5)
┌────────────┬─────────────────────────────────┬────────┬─────────────────────┬─────────────────────┐
│ weaponkind ┆ organunit                       ┆ report ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---                             ┆ ---    ┆ ---                 ┆ ---                 │
│ str        ┆ str                             ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════╪═════════════════════════════════╪════════╪═════════════════════╪═════════════════════╡
│ ПІСТОЛЕТ   ┆ ЧЕРНІГІВСЬКИЙ ВІДДІЛ ПОЛІЦІЇ Г… ┆ Theft  ┆ 2024-07-06 13:52:52 ┆ 2024-07-06 00:00:00 │
└────────────┴─────────────────────────────────┴────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:17:07,152 - DEBUG - Sample (Last): shape: (1, 5)
┌────────────────────┬─────────────────────────────────┬────────┬─────────────────────┬─────────────────────┐
│ weaponkind         ┆ organunit                       ┆ report ┆ insertdate          ┆ theftdate           │
│ ---                ┆ ---                             ┆ ---    ┆ ---                 ┆ ---                 │
│ str                ┆ str                             ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════════════╪═════════════════════════════════╪════════╪═════════════════════╪═════════════════════╡
│ РУШНИЦЯ МИСЛИВСЬКА ┆ НОВОКАХОВСЬКИЙ ВІДДІЛ ПОЛІЦІЇ … ┆ Loss   ┆ 2024-05-06 17:08:00 ┆ 2024-05-06 00:00:00 │
└────────────────────┴─────────────────────────────────┴────────┴─────────────────────┴─────────────────────┘
2025-08-19 11:17:07,152 - INFO - 2/4 Transform 'organunit' column...
2025-08-19 11:17:14,755 - DEBUG - Added new region column.
2025-08-19 11:17:14,755 - DEBUG - Rows: 872,747
2025-08-19 11:17:14,755 - DEBUG - Nulls: [('weaponkind', 0), ('organunit', 0), ('report', 0), ('insertdate', 0), ('theftdate', 596), ('region', 0)]
2025-08-19 11:17:14,755 - DEBUG - Sample (First): shape: (1, 6)
┌──────────────────┬─────────────────────────────────┬────────┬─────────────────────┬─────────────────────┬────────┐
│ weaponkind       ┆ organunit                       ┆ report ┆ insertdate          ┆ theftdate           ┆ region │
│ ---              ┆ ---                             ┆ ---    ┆ ---                 ┆ ---                 ┆ ---    │
│ str              ┆ str                             ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str    │
╞══════════════════╪═════════════════════════════════╪════════╪═════════════════════╪═════════════════════╪════════╡
│ ПІСТОЛЕТ ГАЗОВИЙ ┆ ДНІПРОВСЬКЕ УПРАВЛІННЯ ПОЛІЦІЇ… ┆ Loss   ┆ 2019-07-18 11:48:16 ┆ 2019-07-18 00:00:00 ┆ Dnipro │
└──────────────────┴─────────────────────────────────┴────────┴─────────────────────┴─────────────────────┴────────┘
2025-08-19 11:17:14,755 - DEBUG - Sample (Last): shape: (1, 6)
┌──────────────────────────┬─────────────────────────────────┬────────┬─────────────────────┬─────────────────────┬─────────┐
│ weaponkind               ┆ organunit                       ┆ report ┆ insertdate          ┆ theftdate           ┆ region  │
│ ---                      ┆ ---                             ┆ ---    ┆ ---                 ┆ ---                 ┆ ---     │
│ str                      ┆ str                             ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str     │
╞══════════════════════════╪═════════════════════════════════╪════════╪═════════════════════╪═════════════════════╪═════════╡
│ ПІСТОЛЕТ ПІД ГУМОВУ КУЛЮ ┆ ГОЛОВНЕ УПРАВЛІННЯ НАЦІОНАЛЬНО… ┆ Loss   ┆ 2022-11-14 14:33:26 ┆ 2022-11-14 00:00:00 ┆ Donetsk │
└──────────────────────────┴─────────────────────────────────┴────────┴─────────────────────┴─────────────────────┴─────────┘
2025-08-19 11:17:22,283 - DEBUG - Rows: 872,747
2025-08-19 11:17:22,283 - DEBUG - Nulls: [('weaponkind', 0), ('report', 0), ('insertdate', 0), ('theftdate', 596), ('region', 0)]
2025-08-19 11:17:22,283 - DEBUG - Sample (First): shape: (1, 5)
┌──────────────────────────┬────────┬─────────────────────┬─────────────────────┬─────────┐
│ weaponkind               ┆ report ┆ insertdate          ┆ theftdate           ┆ region  │
│ ---                      ┆ ---    ┆ ---                 ┆ ---                 ┆ ---     │
│ str                      ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str     │
╞══════════════════════════╪════════╪═════════════════════╪═════════════════════╪═════════╡
│ ПІСТОЛЕТ ПІД ГУМОВУ КУЛЮ ┆ Loss   ┆ 2018-01-06 12:08:01 ┆ 2018-01-05 00:00:00 ┆ Kharkiv │
└──────────────────────────┴────────┴─────────────────────┴─────────────────────┴─────────┘
2025-08-19 11:17:22,283 - DEBUG - Sample (Last): shape: (1, 5)
┌────────────┬────────┬─────────────────────┬─────────────────────┬─────────┐
│ weaponkind ┆ report ┆ insertdate          ┆ theftdate           ┆ region  │
│ ---        ┆ ---    ┆ ---                 ┆ ---                 ┆ ---     │
│ str        ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str     │
╞════════════╪════════╪═════════════════════╪═════════════════════╪═════════╡
│ ПІСТОЛЕТ   ┆ Loss   ┆ 2016-02-19 15:28:19 ┆ 2016-02-15 00:00:00 ┆ Donetsk │
└────────────┴────────┴─────────────────────┴─────────────────────┴─────────┘
2025-08-19 11:17:22,283 - INFO - 3/4 Transform 'weaponkind' column...
2025-08-19 11:17:41,052 - DEBUG - Rows: 872,747
2025-08-19 11:17:41,052 - DEBUG - Nulls: [('weaponkind', 0), ('report', 0), ('insertdate', 0), ('theftdate', 596), ('region', 0), ('weaponcategory', 35)]
2025-08-19 11:17:41,054 - DEBUG - Sample (First): shape: (1, 6)
┌────────────┬────────┬─────────────────────┬─────────────────────┬─────────┬────────────────┐
│ weaponkind ┆ report ┆ insertdate          ┆ theftdate           ┆ region  ┆ weaponcategory │
│ ---        ┆ ---    ┆ ---                 ┆ ---                 ┆ ---     ┆ ---            │
│ str        ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str     ┆ str            │
╞════════════╪════════╪═════════════════════╪═════════════════════╪═════════╪════════════════╡
│ АВТОМАТ    ┆ Loss   ┆ 2025-04-02 13:35:34 ┆ 2025-04-01 00:00:00 ┆ Donetsk ┆ Light firearms │
└────────────┴────────┴─────────────────────┴─────────────────────┴─────────┴────────────────┘
2025-08-19 11:17:41,055 - DEBUG - Sample (Last): shape: (1, 6)
┌────────────┬────────┬─────────────────────┬─────────────────────┬─────────┬────────────────┐
│ weaponkind ┆ report ┆ insertdate          ┆ theftdate           ┆ region  ┆ weaponcategory │
│ ---        ┆ ---    ┆ ---                 ┆ ---                 ┆ ---     ┆ ---            │
│ str        ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str     ┆ str            │
╞════════════╪════════╪═════════════════════╪═════════════════════╪═════════╪════════════════╡
│ ПІСТОЛЕТ   ┆ Theft  ┆ 2014-05-29 10:58:43 ┆ 2014-05-09 00:00:00 ┆ Donetsk ┆ Handguns       │
└────────────┴────────┴─────────────────────┴─────────────────────┴─────────┴────────────────┘
2025-08-19 11:17:42,134 - WARNING - 35 records of 5 new weapons present: 'МАГАЗИН АВТОМАТНИЙ', 'ХОЛОДНА ЗБРОЯ', 'МАГАЗИН ГВИНТІВКИ', 'ПІСТОЛЕТ ДРОБОВИЙ', 'ШПАГА'.
Update 'wps_df' with new weapons!
2025-08-19 11:18:06,731 - DEBUG - Rows: 872,116
2025-08-19 11:18:06,731 - DEBUG - Nulls: [('report', 0), ('insertdate', 0), ('theftdate', 0), ('region', 0), ('weaponcategory', 0)]
2025-08-19 11:18:06,731 - DEBUG - Sample (First): shape: (1, 5)
┌────────┬─────────────────────┬─────────────────────┬─────────┬────────────────┐
│ report ┆ insertdate          ┆ theftdate           ┆ region  ┆ weaponcategory │
│ ---    ┆ ---                 ┆ ---                 ┆ ---     ┆ ---            │
│ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str     ┆ str            │
╞════════╪═════════════════════╪═════════════════════╪═════════╪════════════════╡
│ Loss   ┆ 2007-01-03 00:00:00 ┆ 2006-12-19 00:00:00 ┆ Poltava ┆ Light firearms │
└────────┴─────────────────────┴─────────────────────┴─────────┴────────────────┘
2025-08-19 11:18:06,731 - DEBUG - Sample (Last): shape: (1, 5)
┌────────┬─────────────────────┬─────────────────────┬─────────┬────────────────┐
│ report ┆ insertdate          ┆ theftdate           ┆ region  ┆ weaponcategory │
│ ---    ┆ ---                 ┆ ---                 ┆ ---     ┆ ---            │
│ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str     ┆ str            │
╞════════╪═════════════════════╪═════════════════════╪═════════╪════════════════╡
│ Loss   ┆ 2016-06-24 16:54:18 ┆ 2016-06-17 00:00:00 ┆ Donetsk ┆ Handguns       │
└────────┴─────────────────────┴─────────────────────┴─────────┴────────────────┘
2025-08-19 11:18:06,731 - INFO - 4/4 Transform date columns...
2025-08-19 11:18:33,492 - DEBUG - Rows: 869,753
2025-08-19 11:18:33,492 - DEBUG - Nulls: [('report', 0), ('region', 0), ('weaponcategory', 0), ('date', 0)]
2025-08-19 11:18:33,492 - DEBUG - Sample (First): shape: (1, 4)
┌────────┬────────┬────────────────┬─────────────────────┐
│ report ┆ region ┆ weaponcategory ┆ date                │
│ ---    ┆ ---    ┆ ---            ┆ ---                 │
│ str    ┆ str    ┆ str            ┆ datetime[μs]        │
╞════════╪════════╪════════════════╪═════════════════════╡
│ Theft  ┆ Lviv   ┆ Handguns       ┆ 1991-08-26 00:00:00 │
└────────┴────────┴────────────────┴─────────────────────┘
2025-08-19 11:18:33,492 - DEBUG - Sample (Last): shape: (1, 4)
┌────────┬─────────┬────────────────┬─────────────────────┐
│ report ┆ region  ┆ weaponcategory ┆ date                │
│ ---    ┆ ---     ┆ ---            ┆ ---                 │
│ str    ┆ str     ┆ str            ┆ datetime[μs]        │
╞════════╪═════════╪════════════════╪═════════════════════╡
│ Loss   ┆ Kharkiv ┆ Handguns       ┆ 2025-08-11 00:00:00 │
└────────┴─────────┴────────────────┴─────────────────────┘
2025-08-19 11:18:33,492 - INFO - 1/2 Sort columns...
2025-08-19 11:18:58,493 - DEBUG - Rows: 869,753
2025-08-19 11:18:58,493 - DEBUG - Nulls: [('report', 0), ('region', 0), ('weaponcategory', 0), ('date', 0)]
2025-08-19 11:18:58,508 - DEBUG - Sample (First): shape: (1, 4)
┌────────┬────────┬────────────────┬─────────────────────┐
│ report ┆ region ┆ weaponcategory ┆ date                │
│ ---    ┆ ---    ┆ ---            ┆ ---                 │
│ str    ┆ str    ┆ str            ┆ datetime[μs]        │
╞════════╪════════╪════════════════╪═════════════════════╡
│ Theft  ┆ Lviv   ┆ Handguns       ┆ 1991-08-26 00:00:00 │
└────────┴────────┴────────────────┴─────────────────────┘
2025-08-19 11:18:58,508 - DEBUG - Sample (Last): shape: (1, 4)
┌────────┬──────────┬────────────────┬─────────────────────┐
│ report ┆ region   ┆ weaponcategory ┆ date                │
│ ---    ┆ ---      ┆ ---            ┆ ---                 │
│ str    ┆ str      ┆ str            ┆ datetime[μs]        │
╞════════╪══════════╪════════════════╪═════════════════════╡
│ Loss   ┆ Zhytomyr ┆ Light firearms ┆ 2025-08-11 00:00:00 │
└────────┴──────────┴────────────────┴─────────────────────┘
2025-08-19 11:18:58,508 - INFO - 2/2 Export data...
2025-08-19 11:19:05,956 - INFO - Exported data to assets\ua-mia-weapons.parquet.gzip.
2025-08-19 11:19:05,956 - INFO - Pipeline run was successful.
