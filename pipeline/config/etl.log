2025-08-23 00:53:19,737 - INFO - Beginning data extraction...
2025-08-23 00:53:19,737 - INFO - 1/5 Importing data...
2025-08-23 00:53:29,677 - DEBUG - Rows: 873,113
2025-08-23 00:53:29,677 - DEBUG - Nulls: [('brandmodel', 2292), ('producer', 161765), ('weapontype', 5651), ('weaponkind', 1), ('weaponseries', 423225), ('weaponnumber', 1), ('weaponcaliber', 7798), ('trunks', 119483), ('graduationyear', 137993), ('organunit', 4), ('reasonsearch', 0), ('insertdate', 0), ('theftdate', 599)]
2025-08-23 00:53:29,739 - DEBUG - Sample (First): shape: (1, 13)
┌────────────┬────────────┬────────────┬────────────┬───┬────────────────────┬──────────────┬────────────────────┬────────────────────┐
│ brandmodel ┆ producer   ┆ weapontype ┆ weaponkind ┆ … ┆ organunit          ┆ reasonsearch ┆ insertdate         ┆ theftdate          │
│ ---        ┆ ---        ┆ ---        ┆ ---        ┆   ┆ ---                ┆ ---          ┆ ---                ┆ ---                │
│ str        ┆ str        ┆ str        ┆ str        ┆   ┆ str                ┆ str          ┆ str                ┆ str                │
╞════════════╪════════════╪════════════╪════════════╪═══╪════════════════════╪══════════════╪════════════════════╪════════════════════╡
│ НАГАН      ┆ ВІТЧИЗНЯНЕ ┆ НАРІЗНА    ┆ РЕВОЛЬВЕР  ┆ … ┆ МАНГУШСЬКЕ         ┆ ВИКРАДЕННЯ   ┆ 1978-03-09T00:00:0 ┆ 1978-03-09T00:00:0 │
│            ┆            ┆            ┆            ┆   ┆ ВІДДІЛЕННЯ ПОЛІЦІЇ ┆              ┆ 0                  ┆ 0                  │
│            ┆            ┆            ┆            ┆   ┆ …                  ┆              ┆                    ┆                    │
└────────────┴────────────┴────────────┴────────────┴───┴────────────────────┴──────────────┴────────────────────┴────────────────────┘
2025-08-23 00:53:29,755 - DEBUG - Sample (Last): shape: (1, 13)
┌────────────┬──────────┬────────────────┬────────────┬───┬────────────────────┬──────────────┬───────────────────┬───────────────────┐
│ brandmodel ┆ producer ┆ weapontype     ┆ weaponkind ┆ … ┆ organunit          ┆ reasonsearch ┆ insertdate        ┆ theftdate         │
│ ---        ┆ ---      ┆ ---            ┆ ---        ┆   ┆ ---                ┆ ---          ┆ ---               ┆ ---               │
│ str        ┆ str      ┆ str            ┆ str        ┆   ┆ str                ┆ str          ┆ str               ┆ str               │
╞════════════╪══════════╪════════════════╪════════════╪═══╪════════════════════╪══════════════╪═══════════════════╪═══════════════════╡
│ ТОЗБ       ┆ ІНОЗЕМНЕ ┆ ГЛАДКОСТВОЛЬНА ┆ РУШНИЦЯ    ┆ … ┆ КИЄВО-СВЯТОШИНСЬКИ ┆ ВТРАТА       ┆ 2025-07-25T18:43: ┆ 2025-07-24T00:00: │
│            ┆          ┆                ┆ МИСЛИВСЬКА ┆   ┆ Й ВІДДІЛ ПОЛ…      ┆              ┆ 01                ┆ 00                │
└────────────┴──────────┴────────────────┴────────────┴───┴────────────────────┴──────────────┴───────────────────┴───────────────────┘
2025-08-23 00:53:29,802 - DEBUG - Estimated Size: 204 MB
2025-08-23 00:53:29,802 - INFO - 2/5 Dropping duplicates...
2025-08-23 00:53:32,100 - DEBUG - Rows: 872,752
2025-08-23 00:53:32,100 - DEBUG - Nulls: [('brandmodel', 2283), ('producer', 161708), ('weapontype', 5632), ('weaponkind', 1), ('weaponseries', 423044), ('weaponnumber', 1), ('weaponcaliber', 7785), ('trunks', 119440), ('graduationyear', 137881), ('organunit', 4), ('reasonsearch', 0), ('insertdate', 0), ('theftdate', 599)]
2025-08-23 00:53:32,100 - DEBUG - Sample (First): shape: (1, 13)
┌────────────┬──────────┬────────────┬────────────┬───┬─────────────────────┬──────────────┬─────────────────────┬────────────────────┐
│ brandmodel ┆ producer ┆ weapontype ┆ weaponkind ┆ … ┆ organunit           ┆ reasonsearch ┆ insertdate          ┆ theftdate          │
│ ---        ┆ ---      ┆ ---        ┆ ---        ┆   ┆ ---                 ┆ ---          ┆ ---                 ┆ ---                │
│ str        ┆ str      ┆ str        ┆ str        ┆   ┆ str                 ┆ str          ┆ str                 ┆ str                │
╞════════════╪══════════╪════════════╪════════════╪═══╪═════════════════════╪══════════════╪═════════════════════╪════════════════════╡
│ ПМ         ┆ ІНОЗЕМНЕ ┆ НАРІЗНА    ┆ ПІСТОЛЕТ   ┆ … ┆ ГОЛОВНЕ УПРАВЛІННЯ  ┆ ВИКРАДЕННЯ   ┆ 2017-10-03T14:39:16 ┆ 2014-03-31T00:00:0 │
│            ┆          ┆            ┆            ┆   ┆ НАЦІОНАЛЬНО…        ┆              ┆                     ┆ 0                  │
└────────────┴──────────┴────────────┴────────────┴───┴─────────────────────┴──────────────┴─────────────────────┴────────────────────┘
2025-08-23 00:53:32,100 - DEBUG - Sample (Last): shape: (1, 13)
┌────────────┬──────────┬────────────┬────────────┬───┬─────────────────────┬──────────────┬─────────────────────┬────────────────────┐
│ brandmodel ┆ producer ┆ weapontype ┆ weaponkind ┆ … ┆ organunit           ┆ reasonsearch ┆ insertdate          ┆ theftdate          │
│ ---        ┆ ---      ┆ ---        ┆ ---        ┆   ┆ ---                 ┆ ---          ┆ ---                 ┆ ---                │
│ str        ┆ str      ┆ str        ┆ str        ┆   ┆ str                 ┆ str          ┆ str                 ┆ str                │
╞════════════╪══════════╪════════════╪════════════╪═══╪═════════════════════╪══════════════╪═════════════════════╪════════════════════╡
│ АК74       ┆ null     ┆ НАРІЗНА    ┆ АВТОМАТ    ┆ … ┆ ГОЛОВНЕ УПРАВЛІННЯ  ┆ ВТРАТА       ┆ 2024-11-30T11:08:13 ┆ 2024-11-29T00:00:0 │
│            ┆          ┆            ┆            ┆   ┆ НАЦІОНАЛЬНО…        ┆              ┆                     ┆ 0                  │
└────────────┴──────────┴────────────┴────────────┴───┴─────────────────────┴──────────────┴─────────────────────┴────────────────────┘
2025-08-23 00:53:32,100 - INFO - 3/5 Selecting columns...
2025-08-23 00:53:33,069 - DEBUG - Rows: 872,752
2025-08-23 00:53:33,069 - DEBUG - Nulls: [('weaponkind', 1), ('organunit', 4), ('reasonsearch', 0), ('insertdate', 0), ('theftdate', 599)]
2025-08-23 00:53:33,069 - DEBUG - Sample (First): shape: (1, 5)
┌────────────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind         ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---                ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str                ┆ str                             ┆ str          ┆ str                 ┆ str                 │
╞════════════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ РУШНИЦЯ МИСЛИВСЬКА ┆ ОБУХІВСЬКИЙ ВІДДІЛ ПОЛІЦІЇ ГУН… ┆ ВТРАТА       ┆ 2024-08-01T16:34:58 ┆ 2024-07-29T00:00:00 │
└────────────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-23 00:53:33,069 - DEBUG - Sample (Last): shape: (1, 5)
┌────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str                             ┆ str          ┆ str                 ┆ str                 │
╞════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ ПІСТОЛЕТ   ┆ БАХМУТСЬКИЙ ВІДДІЛ ПОЛІЦІЇ ГУН… ┆ ВТРАТА       ┆ 2023-09-27T16:03:23 ┆ 2023-02-28T00:00:00 │
└────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-23 00:53:33,069 - INFO - 4/5 Casting datatypes...
2025-08-23 00:53:35,834 - DEBUG - Rows: 872,752
2025-08-23 00:53:35,834 - DEBUG - Nulls: [('weaponkind', 1), ('organunit', 4), ('reasonsearch', 0), ('insertdate', 0), ('theftdate', 599)]
2025-08-23 00:53:35,944 - DEBUG - Sample (First): shape: (1, 5)
┌────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str                             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ АВТОМАТ    ┆ ГОЛОВНЕ УПРАВЛІННЯ НАЦІОНАЛЬНО… ┆ ВТРАТА       ┆ 2023-11-23 16:34:28 ┆ 2023-05-28 00:00:00 │
└────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-23 00:53:35,944 - DEBUG - Sample (Last): shape: (1, 5)
┌────────────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind         ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---                ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str                ┆ str                             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ РУШНИЦЯ МИСЛИВСЬКА ┆ ДАРНИЦЬКЕ УПРАВЛІННЯ ПОЛІЦІЇ Г… ┆ ВТРАТА       ┆ 2024-10-23 10:13:21 ┆ 2024-10-23 00:00:00 │
└────────────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-23 00:53:35,944 - INFO - 5/5 Dropping nulls...
2025-08-23 00:53:38,912 - DEBUG - Dropped rows full of nulls.
2025-08-23 00:53:38,912 - DEBUG - Rows: 872,752
2025-08-23 00:53:38,912 - DEBUG - Nulls: [('weaponkind', 1), ('organunit', 4), ('reasonsearch', 0), ('insertdate', 0), ('theftdate', 599)]
2025-08-23 00:53:38,912 - DEBUG - Sample (First): shape: (1, 5)
┌────────────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind         ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---                ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str                ┆ str                             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ РУШНИЦЯ МИСЛИВСЬКА ┆ КИЄВО-СВЯТОШИНСЬКИЙ ВІДДІЛ ПОЛ… ┆ ВТРАТА       ┆ 2025-07-28 19:32:59 ┆ 2025-07-28 00:00:00 │
└────────────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-23 00:53:38,912 - DEBUG - Sample (Last): shape: (1, 5)
┌────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str                             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ КАРАБІН    ┆ КОРОСТИШІВСЬКИЙ ВІДДІЛ ПОЛІЦІЇ… ┆ ВТРАТА       ┆ 2023-10-02 18:13:01 ┆ 2022-02-24 00:00:00 │
└────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-23 00:53:41,053 - DEBUG - Dropped rows with any string values missing.
2025-08-23 00:53:41,053 - DEBUG - Rows: 872,747
2025-08-23 00:53:41,053 - DEBUG - Nulls: [('weaponkind', 0), ('organunit', 0), ('reasonsearch', 0), ('insertdate', 0), ('theftdate', 596)]
2025-08-23 00:53:41,053 - DEBUG - Sample (First): shape: (1, 5)
┌────────────┬─────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind ┆ organunit       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---             ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════╪═════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ ПІСТОЛЕТ   ┆ АПАРАТ М.ЛЬВОВА ┆ ВИКРАДЕННЯ   ┆ 2014-02-26 16:29:05 ┆ 2014-02-19 00:00:00 │
└────────────┴─────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-23 00:53:41,053 - DEBUG - Sample (Last): shape: (1, 5)
┌────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str                             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ АВТОМАТ    ┆ ВОЗНЕСЕНСЬКИЙ ВІДДІЛ ПОЛІЦІЇ Г… ┆ ВТРАТА       ┆ 2024-10-09 12:30:49 ┆ 2022-03-18 00:00:00 │
└────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-23 00:53:42,897 - DEBUG - Dropped rows with both datetime values missing.
2025-08-23 00:53:42,897 - DEBUG - Rows: 872,747
2025-08-23 00:53:42,897 - DEBUG - Nulls: [('weaponkind', 0), ('organunit', 0), ('reasonsearch', 0), ('insertdate', 0), ('theftdate', 596)]
2025-08-23 00:53:42,897 - DEBUG - Sample (First): shape: (1, 5)
┌────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---        ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str        ┆ str                             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ ПІСТОЛЕТ   ┆ ГОЛОВНЕ УПРАВЛІННЯ НАЦІОНАЛЬНО… ┆ ВТРАТА       ┆ 2017-08-17 16:34:30 ┆ 2014-03-31 00:00:00 │
└────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-23 00:53:42,897 - DEBUG - Sample (Last): shape: (1, 5)
┌────────────────────┬─────────────────────────────────┬──────────────┬─────────────────────┬─────────────────────┐
│ weaponkind         ┆ organunit                       ┆ reasonsearch ┆ insertdate          ┆ theftdate           │
│ ---                ┆ ---                             ┆ ---          ┆ ---                 ┆ ---                 │
│ str                ┆ str                             ┆ str          ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════════════╪═════════════════════════════════╪══════════════╪═════════════════════╪═════════════════════╡
│ РУШНИЦЯ МИСЛИВСЬКА ┆ ТЕРНОПІЛЬСЬКИЙ ВІДДІЛ ПОЛІЦІЇ … ┆ ВТРАТА       ┆ 2021-12-13 12:13:03 ┆ 2021-12-13 00:00:00 │
└────────────────────┴─────────────────────────────────┴──────────────┴─────────────────────┴─────────────────────┘
2025-08-23 00:53:42,897 - INFO - Beginning data transformation...
2025-08-23 00:53:42,897 - INFO - 1/4 Transforming 'reasonsearch' column...
2025-08-23 00:53:44,944 - DEBUG - Rows: 872,747
2025-08-23 00:53:44,944 - DEBUG - Nulls: [('weaponkind', 0), ('organunit', 0), ('report', 0), ('insertdate', 0), ('theftdate', 596)]
2025-08-23 00:53:44,944 - DEBUG - Sample (First): shape: (1, 5)
┌──────────────────────────┬─────────────────────────────────┬────────┬─────────────────────┬─────────────────────┐
│ weaponkind               ┆ organunit                       ┆ report ┆ insertdate          ┆ theftdate           │
│ ---                      ┆ ---                             ┆ ---    ┆ ---                 ┆ ---                 │
│ str                      ┆ str                             ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        │
╞══════════════════════════╪═════════════════════════════════╪════════╪═════════════════════╪═════════════════════╡
│ ПІСТОЛЕТ ПІД ГУМОВУ КУЛЮ ┆ ГОЛОВНЕ УПРАВЛІННЯ НАЦІОНАЛЬНО… ┆ Loss   ┆ 2017-03-22 15:14:58 ┆ 2017-03-03 00:00:00 │
└──────────────────────────┴─────────────────────────────────┴────────┴─────────────────────┴─────────────────────┘
2025-08-23 00:53:44,944 - DEBUG - Sample (Last): shape: (1, 5)
┌────────────────────┬─────────────────────────────────┬────────┬─────────────────────┬─────────────────────┐
│ weaponkind         ┆ organunit                       ┆ report ┆ insertdate          ┆ theftdate           │
│ ---                ┆ ---                             ┆ ---    ┆ ---                 ┆ ---                 │
│ str                ┆ str                             ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        │
╞════════════════════╪═════════════════════════════════╪════════╪═════════════════════╪═════════════════════╡
│ РУШНИЦЯ МИСЛИВСЬКА ┆ ГОЛОВНЕ УПРАВЛІННЯ НАЦІОНАЛЬНО… ┆ Loss   ┆ 2017-05-19 16:38:47 ┆ 2017-03-03 00:00:00 │
└────────────────────┴─────────────────────────────────┴────────┴─────────────────────┴─────────────────────┘
2025-08-23 00:53:44,944 - INFO - 2/4 Transforming 'organunit' column...
2025-08-23 00:53:52,334 - DEBUG - Added new region column.
2025-08-23 00:53:52,334 - DEBUG - Rows: 872,747
2025-08-23 00:53:52,334 - DEBUG - Nulls: [('weaponkind', 0), ('organunit', 0), ('report', 0), ('insertdate', 0), ('theftdate', 596), ('region', 469)]
2025-08-23 00:53:52,334 - DEBUG - Sample (First): shape: (1, 6)
┌────────────────────┬─────────────────────────────────┬────────┬─────────────────────┬─────────────────────┬─────────┐
│ weaponkind         ┆ organunit                       ┆ report ┆ insertdate          ┆ theftdate           ┆ region  │
│ ---                ┆ ---                             ┆ ---    ┆ ---                 ┆ ---                 ┆ ---     │
│ str                ┆ str                             ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str     │
╞════════════════════╪═════════════════════════════════╪════════╪═════════════════════╪═════════════════════╪═════════╡
│ РУШНИЦЯ МИСЛИВСЬКА ┆ НОВОТРОЇЦЬКЕ ВІДДІЛЕННЯ ПОЛІЦІ… ┆ Loss   ┆ 2024-04-30 14:38:15 ┆ 2024-04-30 00:00:00 ┆ Kherson │
└────────────────────┴─────────────────────────────────┴────────┴─────────────────────┴─────────────────────┴─────────┘
2025-08-23 00:53:52,350 - DEBUG - Sample (Last): shape: (1, 6)
┌──────────────────────────┬─────────────────────────────────┬────────┬─────────────────────┬─────────────────────┬────────┐
│ weaponkind               ┆ organunit                       ┆ report ┆ insertdate          ┆ theftdate           ┆ region │
│ ---                      ┆ ---                             ┆ ---    ┆ ---                 ┆ ---                 ┆ ---    │
│ str                      ┆ str                             ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str    │
╞══════════════════════════╪═════════════════════════════════╪════════╪═════════════════════╪═════════════════════╪════════╡
│ ПІСТОЛЕТ ПІД ГУМОВУ КУЛЮ ┆ КИЄВО-СВЯТОШИНСЬКИЙ ВІДДІЛ ПОЛ… ┆ Loss   ┆ 2025-04-15 09:47:10 ┆ 2025-04-14 00:00:00 ┆ Kyiv   │
└──────────────────────────┴─────────────────────────────────┴────────┴─────────────────────┴─────────────────────┴────────┘
2025-08-23 00:54:14,011 - DEBUG - Rows: 872,278
2025-08-23 00:54:14,011 - DEBUG - Nulls: [('weaponkind', 0), ('report', 0), ('insertdate', 0), ('theftdate', 596), ('region', 0)]
2025-08-23 00:54:14,011 - DEBUG - Sample (First): shape: (1, 5)
┌────────────────────┬────────┬─────────────────────┬─────────────────────┬──────────────┐
│ weaponkind         ┆ report ┆ insertdate          ┆ theftdate           ┆ region       │
│ ---                ┆ ---    ┆ ---                 ┆ ---                 ┆ ---          │
│ str                ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str          │
╞════════════════════╪════════╪═════════════════════╪═════════════════════╪══════════════╡
│ РУШНИЦЯ МИСЛИВСЬКА ┆ Loss   ┆ 2022-09-18 00:50:25 ┆ 2022-09-13 00:00:00 ┆ Zaporizhzhia │
└────────────────────┴────────┴─────────────────────┴─────────────────────┴──────────────┘
2025-08-23 00:54:14,011 - DEBUG - Sample (Last): shape: (1, 5)
┌──────────────────────────┬────────┬─────────────────────┬─────────────────────┬────────┐
│ weaponkind               ┆ report ┆ insertdate          ┆ theftdate           ┆ region │
│ ---                      ┆ ---    ┆ ---                 ┆ ---                 ┆ ---    │
│ str                      ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str    │
╞══════════════════════════╪════════╪═════════════════════╪═════════════════════╪════════╡
│ ПІСТОЛЕТ ПІД ГУМОВУ КУЛЮ ┆ Loss   ┆ 2025-05-17 12:23:25 ┆ 2025-05-16 00:00:00 ┆ Kyiv   │
└──────────────────────────┴────────┴─────────────────────┴─────────────────────┴────────┘
2025-08-23 00:54:14,011 - INFO - 3/4 Transforming 'weaponkind' column...
2025-08-23 00:54:36,839 - DEBUG - Rows: 872,278
2025-08-23 00:54:36,839 - DEBUG - Nulls: [('weaponkind', 0), ('report', 0), ('insertdate', 0), ('theftdate', 596), ('region', 0), ('weaponcategory', 35)]
2025-08-23 00:54:36,901 - DEBUG - Sample (First): shape: (1, 6)
┌────────────┬────────┬─────────────────────┬─────────────────────┬────────────┬────────────────┐
│ weaponkind ┆ report ┆ insertdate          ┆ theftdate           ┆ region     ┆ weaponcategory │
│ ---        ┆ ---    ┆ ---                 ┆ ---                 ┆ ---        ┆ ---            │
│ str        ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str        ┆ str            │
╞════════════╪════════╪═════════════════════╪═════════════════════╪════════════╪════════════════╡
│ ПІСТОЛЕТ   ┆ Theft  ┆ 2020-12-22 13:58:38 ┆ 2017-05-11 00:00:00 ┆ Simferopol ┆ Handguns       │
└────────────┴────────┴─────────────────────┴─────────────────────┴────────────┴────────────────┘
2025-08-23 00:54:36,901 - DEBUG - Sample (Last): shape: (1, 6)
┌────────────────────┬────────┬─────────────────────┬─────────────────────┬──────────────┬────────────────┐
│ weaponkind         ┆ report ┆ insertdate          ┆ theftdate           ┆ region       ┆ weaponcategory │
│ ---                ┆ ---    ┆ ---                 ┆ ---                 ┆ ---          ┆ ---            │
│ str                ┆ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str          ┆ str            │
╞════════════════════╪════════╪═════════════════════╪═════════════════════╪══════════════╪════════════════╡
│ РУШНИЦЯ МИСЛИВСЬКА ┆ Loss   ┆ 2022-09-18 01:33:23 ┆ 2022-09-13 00:00:00 ┆ Zaporizhzhia ┆ Light firearms │
└────────────────────┴────────┴─────────────────────┴─────────────────────┴──────────────┴────────────────┘
2025-08-23 00:54:48,652 - WARNING - Update weapon_mappings in config.yaml with new weapons!
35 records of 5 new weapons present: 'ХОЛОДНА ЗБРОЯ', 'ШПАГА', 'ПІСТОЛЕТ ДРОБОВИЙ', 'МАГАЗИН АВТОМАТНИЙ', 'МАГАЗИН ГВИНТІВКИ'.
2025-08-23 00:55:13,594 - DEBUG - Rows: 872,243
2025-08-23 00:55:13,594 - DEBUG - Nulls: [('report', 0), ('insertdate', 0), ('theftdate', 596), ('region', 0), ('weaponcategory', 0)]
2025-08-23 00:55:13,594 - DEBUG - Sample (First): shape: (1, 5)
┌────────┬─────────────────────┬─────────────────────┬─────────┬────────────────┐
│ report ┆ insertdate          ┆ theftdate           ┆ region  ┆ weaponcategory │
│ ---    ┆ ---                 ┆ ---                 ┆ ---     ┆ ---            │
│ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str     ┆ str            │
╞════════╪═════════════════════╪═════════════════════╪═════════╪════════════════╡
│ Loss   ┆ 2025-05-12 21:43:09 ┆ 2025-04-22 00:00:00 ┆ Kherson ┆ Light firearms │
└────────┴─────────────────────┴─────────────────────┴─────────┴────────────────┘
2025-08-23 00:55:13,594 - DEBUG - Sample (Last): shape: (1, 5)
┌────────┬─────────────────────┬─────────────────────┬────────┬────────────────┐
│ report ┆ insertdate          ┆ theftdate           ┆ region ┆ weaponcategory │
│ ---    ┆ ---                 ┆ ---                 ┆ ---    ┆ ---            │
│ str    ┆ datetime[μs]        ┆ datetime[μs]        ┆ str    ┆ str            │
╞════════╪═════════════════════╪═════════════════════╪════════╪════════════════╡
│ Loss   ┆ 2025-04-22 17:23:48 ┆ 2025-04-22 00:00:00 ┆ Dnipro ┆ Light firearms │
└────────┴─────────────────────┴─────────────────────┴────────┴────────────────┘
2025-08-23 00:55:13,594 - INFO - 4/4 Transforming date columns...
2025-08-23 00:55:38,085 - DEBUG - Rows: 869,875
2025-08-23 00:55:38,085 - DEBUG - Nulls: [('report', 0), ('region', 0), ('weaponcategory', 0), ('date', 0)]
2025-08-23 00:55:38,085 - DEBUG - Sample (First): shape: (1, 4)
┌────────┬────────┬────────────────┬─────────────────────┐
│ report ┆ region ┆ weaponcategory ┆ date                │
│ ---    ┆ ---    ┆ ---            ┆ ---                 │
│ str    ┆ str    ┆ str            ┆ datetime[μs]        │
╞════════╪════════╪════════════════╪═════════════════════╡
│ Theft  ┆ Lviv   ┆ Handguns       ┆ 1991-08-26 00:00:00 │
└────────┴────────┴────────────────┴─────────────────────┘
2025-08-23 00:55:38,085 - DEBUG - Sample (Last): shape: (1, 4)
┌────────┬────────┬────────────────┬─────────────────────┐
│ report ┆ region ┆ weaponcategory ┆ date                │
│ ---    ┆ ---    ┆ ---            ┆ ---                 │
│ str    ┆ str    ┆ str            ┆ datetime[μs]        │
╞════════╪════════╪════════════════╪═════════════════════╡
│ Loss   ┆ Kyiv   ┆ Handguns       ┆ 2025-08-11 00:00:00 │
└────────┴────────┴────────────────┴─────────────────────┘
2025-08-23 00:55:38,085 - INFO - Beginning data loading...
2025-08-23 00:55:38,085 - INFO - 1/2 Sorting columns...
2025-08-23 00:56:02,305 - DEBUG - Rows: 869,875
2025-08-23 00:56:02,305 - DEBUG - Nulls: [('report', 0), ('region', 0), ('weaponcategory', 0), ('date', 0)]
2025-08-23 00:56:02,306 - DEBUG - Sample (First): shape: (1, 4)
┌────────┬────────┬────────────────┬─────────────────────┐
│ report ┆ region ┆ weaponcategory ┆ date                │
│ ---    ┆ ---    ┆ ---            ┆ ---                 │
│ str    ┆ str    ┆ str            ┆ datetime[μs]        │
╞════════╪════════╪════════════════╪═════════════════════╡
│ Theft  ┆ Lviv   ┆ Handguns       ┆ 1991-08-26 00:00:00 │
└────────┴────────┴────────────────┴─────────────────────┘
2025-08-23 00:56:02,307 - DEBUG - Sample (Last): shape: (1, 4)
┌────────┬──────────┬────────────────┬─────────────────────┐
│ report ┆ region   ┆ weaponcategory ┆ date                │
│ ---    ┆ ---      ┆ ---            ┆ ---                 │
│ str    ┆ str      ┆ str            ┆ datetime[μs]        │
╞════════╪══════════╪════════════════╪═════════════════════╡
│ Loss   ┆ Zhytomyr ┆ Light firearms ┆ 2025-08-11 00:00:00 │
└────────┴──────────┴────────────────┴─────────────────────┘
2025-08-23 00:56:02,307 - INFO - 2/2 Exporting data...
2025-08-23 00:56:09,952 - INFO - Exported data to 'data\processed\ua-mia-weapons.parquet'.
2025-08-23 00:56:09,952 - INFO - Pipeline run was successful.
